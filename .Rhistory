if (i == 1) {
path <- paste0(path, pieces[i, 1])
} else {
path <- paste0(path, "/", pieces[i, 1])
}
}
setwd(path)
data <- read.xlsx("EW.xlsx", 1)
View(data)
summary(data)
data$Ort <- factor(data$Ort)
data$Ort <- factor(data$Ort)
data$Platz <- factor(data$Platz)
summary(data)
data[,6]
sum(data[,6])
df <- as.data.frame(NULL)
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 1:(ncol(data) - 1)) {
if (i < 6 | sum(data[,i] > (nrow(data) / 3))) {
df <- cbind(df, data[,i])
}
}
df = NULL
df == NULL
df <- as.data.frame(NULL)
df == NULL
7 == 9
as.logical(df == NULL)
df <- as.data.frame(data[,1])
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 | sum(data[,i] > (nrow(data) / 3))) {
df <- cbind(df, data[,i])
}
}
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
df <- cbind(df, data[,i])
} else {
if (sum(data[,i] > (nrow(data) / 3))) {
df <- cbind(df, data[,i])
}
}
}
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
df <- cbind(df, data[,i])
} else {
print(sum(data[,i] / 3))
if (sum(data[,i] > (nrow(data) / 3))) {
df <- cbind(df, data[,i])
}
}
}
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
df <- cbind(df, data[,i])
} else {
print(sum(data[,i]))
if (sum(data[,i] > (nrow(data) / 3))) {
df <- cbind(df, data[,i])
}
}
}
(nrow(data) / 3)
View(df)
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
df <- cbind(df, data[,i])
} else {
print(sum(data[,i]))
if (sum(data[,i] > (nrow(data) / 3))) {
print(names(data)[i])
df <- cbind(df, data[,i])
}
}
}
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
border <- nrow(data) / 3
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
df <- cbind(df, data[,i])
} else {
print(sum(data[,i]))
if (sum(data[,i]) > (nrow(data) / 3)) {
print(names(data)[i])
df <- cbind(df, data[,i])
}
}
}
View(df)
data[,2]
View(df)
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
print(i)
df <- cbind(df, data[,i])
} else {
if (sum(data[,i]) > (nrow(data) / 3)) {
print(i)
print(names(data)[i])
df <- cbind(df, data[,i])
}
}
}
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
print(data[,i])
df <- cbind(df, data[,i])
} else {
if (sum(data[,i]) > (nrow(data) / 3)) {
print(i)
print(names(data)[i])
df <- cbind(df, data[,i])
}
}
}
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
print(data[,i])
df <- cbind(df, data[,i])
} else {
if (sum(data[,i]) > (nrow(data) / 3)) {
df <- cbind(df, data[,i])
}
}
}
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
print(data[,i])
df <- cbind(df, data[,i])
print(summary(df))
} else {
if (sum(data[,i]) > (nrow(data) / 3)) {
df <- cbind(df, data[,i])
}
}
}
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
print(i)
df <- cbind(df, data[,i])
print(summary(df))
} else {
if (sum(data[,i]) > (nrow(data) / 3)) {
df <- cbind(df, data[,i])
}
}
}
df <- as.data.frame(data[,1])
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
print(i)
df <- cbind(df, data[,i])
print(summary(df))
} else {
if (sum(data[,i]) > (nrow(data) / 3)) {
df <- cbind(df, data[,i])
}
}
}
View(df)
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
df <- cbind(df, data[,i])
print(summary(df))
} else {
if (sum(data[,i]) > (nrow(data) / 3)) {
print(names(data[i]))
df <- cbind(df, data[,i])
}
}
}
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
df <- cbind(df, data[,i])
print(summary(df))
} else {
if (sum(data[,i]) > (nrow(data) / 4)) {
print(names(data[i]))
df <- cbind(df, data[,i])
}
}
}
df <- as.data.frame(data[,1])
var_names <- NULL
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
df <- cbind(df, data[,i])
var_names <- c(var_names, names(data)[i])
} else {
if (sum(data[,i]) > (nrow(data) / 4)) {
var_names <- c(var_names, names(data)[i])
df <- cbind(df, data[,i])
}
}
}
names(df) <- var_names
summary(df)
as.formula(a+b) + as.formula(c+d)
as.formula(1+2) + as.formula(3+4)
typeof(quote(x * 10))
class(quote(x * 10))
c <- y ~ x
d <- y ~ z
c + d
c[[1]]
c[[2]]
formulae <- list(c, d)
formulae
summary(df)
View(data)
df <- as.data.frame(data[,1])
var_names <- names(data)[1]
##Pruefen, ob die Spieler haeufig genug eingesetzt wurden
for (i in 2:(ncol(data) - 1)) {
if (i < 6 ) {
df <- cbind(df, data[,i])
var_names <- c(var_names, names(data)[i])
} else {
if (sum(data[,i]) > (nrow(data) / 4)) {
var_names <- c(var_names, names(data)[i])
df <- cbind(df, data[,i])
}
}
}
##Zuweisen der Variablennamen
names(df) <- var_names
f <- NULL
for(i in 5:ncol(df)) {
f <- c(f, names(df)[i])
}
lapply(f, as.formula)
f
typeof(f[1])
class(f[1])
terms(c)
c
c[[1]]
c[[2]]
c[[3]]
c[[4]]
c[[4]] <- +
1
c[[4]]
c
c[[1]]
c[[4]] <- "+"
c[[5]] <- z
all.vars(c)
names(df)
#Erstellen des lm-Modells
##Erstellen der Formel
f <- Ereignis ~ names(df)[6]
as.formula(paste(f, names(df)[7], sep = "+"))
as.formula(paste("y ~ x1 + x2", "x3", sep = "+"))
factors <- c("x2", "x3")
as.formula(paste("y~", paste(factors, collapse="+")))
f <- NULL
for(i in 6:ncol(df)) {
f <- c(f, names(df)[i])
}
factors(f)
as.formula(paste("y~", paste(f, collapse="+")))
summary(df)
as.formula(paste("Ereignis ~ Punkteschnitt + Ort + Platz", paste(f, collapse="+")))
as.formula(paste("Ereignis ~", paste(f, collapse="+")))
f <- NULL
for(i in 6:ncol(df)) {
f <- c(f, names(df)[i])
}
f <- c("Punkteschnitt", "Ort", "Platz", f)
as.formula(paste("Ereignis ~", paste(f, collapse="+")))
model <- lm(formula = formel, data = df)
formel <- as.formula(paste("Ereignis ~", paste(f, collapse="+")))
model <- lm(formula = formel, data = df)
summary(model)
model_lim <- lm(formula = Ereignis ~ Punkteschnitt + Platz + Ort)
model_lim <- lm(formula = Ereignis ~ Punkteschnitt + Platz + Ort, data = df)
summary(model_lim)
summary(model)
model_df <- as.data.frame(model)
model$coefficients
as.character(formel)
as.character(formel[3])
model_df <- cbind(str_split(as.character(formel[3]), " + "))
as.numeric(model$coefficients)
model_df <- cbind(str_split(as.character(formel[3]), " + "),
as.numeric(model$coefficients))
View(model_df)
model_df <- as.data.frame(cbind(str_split(as.character(formel[3]), " + "),
as.numeric(model$coefficients)))
View(model_df)
as.character(formel[3])
str_split(as.character(formel[3]), "+")
typeof(as.character(formel[3]))
str_split(formel[3], "+")
a <- "a,b"
typeof(a)
str_split(a, ",")
formel[3]
as.character(formel[3])
str_split(as.character(formel[3], "+")
str_split(as.character(formel[3], "+"))
str_split(as.character(formel[3], "+"))
str_split(as.character(formel[3]), "+")
f
model_df <- as.data.frame(cbind(f, as.numeric(model$coefficients)))
length(f)
nrow(model_df)
model_df <- as.data.frame(cbind(c("Intercept", f), as.numeric(model$coefficients)))
View(model_df)
library(ggplot2)
names(model_df) <- c("Coefficient", "Value")
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar()
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity")
summary(model_df)
model_df$Coefficient <- as.factor(model_df$Coefficient)
model_df$Value <- as.factor(model_df$Value)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity")
summary(model_df)
model_df$Value <- as.numeric(model_df$Value)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity")
View(model_df)
model_df <- as.data.frame(cbind(c("Intercept", f), as.numeric(model$coefficients)))
names(model_df) <- c("Coefficient", "Value")
model_df$Coefficient <- as.factor(model_df$Coefficient)
model_df$Value <- as.numeric(model_df$Value)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity")
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
model_df <- as.data.frame(cbind(c("Intercept", f), as.numeric(model$coefficients)))
names(model_df) <- c("Coefficient", "Value")
model_df$Coefficient <- factor(model_df$Coefficient, levels = c("Punkteschnitt",
"Ort",
"Platz",
f),
ordered = TRUE
)
model_df$Value <- as.numeric(model_df$Value)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
f <- f[!f %in% Punkteschnitt]
f <- f[!f %in% "Punkteschnitt"]
players <- f[!f %in% "Punkteschnitt" | !f %in% "Ort" | !f %in% "Platz"]
f
f <- NULL
for(i in 6:ncol(df)) {
f <- c(f, names(df)[i])
}
###Diese Angaben gehoeren immer zur Formel
f <- c("Punkteschnitt", "Ort", "Platz", f)
###Endgueltige Formel
formel <- as.formula(paste("Ereignis ~", paste(f, collapse="+")))
model <- lm(formula = formel, data = df)
summary(model)
model_df <- as.data.frame(cbind(c("Intercept", f), as.numeric(model$coefficients)))
names(model_df) <- c("Coefficient", "Value")
players <- f[!f %in% "Punkteschnitt" | !f %in% "Ort" | !f %in% "Platz"]
f
players <- f[!f %in% "Punkteschnitt" & !f %in% "Ort" & !f %in% "Platz"]
f
players <- f[!f %in% "Punkteschnitt"]
players
players <- f[!f %in% "Punkteschnitt" | !f %in% "Ort" | !f %in% "Platz"]
players
f <- NULL
for(i in 6:ncol(df)) {
f <- c(f, names(df)[i])
}
###Diese Angaben gehoeren immer zur Formel
f <- c("Punkteschnitt", "Ort", "Platz", f)
###Endgueltige Formel
formel <- as.formula(paste("Ereignis ~", paste(f, collapse="+")))
model <- lm(formula = formel, data = df)
summary(model)
model_df <- as.data.frame(cbind(c("Intercept", f), as.numeric(model$coefficients)))
names(model_df) <- c("Coefficient", "Value")
players <- f[!f %in% "Punkteschnitt"]
players <- f[!f %in% "Ort"]
players <- f[!f %in% "Platz"]
model_df$Coefficient <- factor(model_df$Coefficient, levels = c("Punkteschnitt",
"Ort",
"Platz",
players),
ordered = TRUE
)
model_df$Value <- as.numeric(model_df$Value)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
players
f <- NULL
for(i in 6:ncol(df)) {
f <- c(f, names(df)[i])
}
###Diese Angaben gehoeren immer zur Formel
f <- c("Punkteschnitt", "Ort", "Platz", f)
###Endgueltige Formel
formel <- as.formula(paste("Ereignis ~", paste(f, collapse="+")))
model <- lm(formula = formel, data = df)
summary(model)
model_df <- as.data.frame(cbind(c("Intercept", f), as.numeric(model$coefficients)))
names(model_df) <- c("Coefficient", "Value")
players <- f[!f %in% "Punkteschnitt"]
players <- players[!f %in% "Ort"]
players <- players[!f %in% "Platz"]
model_df$Coefficient <- factor(model_df$Coefficient, levels = c("Punkteschnitt",
"Ort",
"Platz",
players),
ordered = TRUE
)
model_df$Value <- as.numeric(model_df$Value)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
f <- NULL
for(i in 6:ncol(df)) {
f <- c(f, names(df)[i])
}
###Diese Angaben gehoeren immer zur Formel
f <- c("Punkteschnitt", "Ort", "Platz", f)
###Endgueltige Formel
formel <- as.formula(paste("Ereignis ~", paste(f, collapse="+")))
model <- lm(formula = formel, data = df)
summary(model)
model_df <- as.data.frame(cbind(c("Intercept", f), as.numeric(model$coefficients)))
names(model_df) <- c("Coefficient", "Value")
players <- f[!f %in% "Punkteschnitt"]
players <- players[!players %in% "Ort"]
players <- players[!players %in% "Platz"]
model_df$Coefficient <- factor(model_df$Coefficient, levels = c("Punkteschnitt",
"Ort",
"Platz",
players),
ordered = TRUE
)
model_df$Value <- as.numeric(model_df$Value)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
players
View(model_df)
f <- NULL
for(i in 6:ncol(df)) {
f <- c(f, names(df)[i])
}
###Diese Angaben gehoeren immer zur Formel
f <- c("Punkteschnitt", "Ort", "Platz", f)
###Endgueltige Formel
formel <- as.formula(paste("Ereignis ~", paste(f, collapse="+")))
model <- lm(formula = formel, data = df)
summary(model)
model_df <- as.data.frame(cbind(c("Intercept", f), as.numeric(model$coefficients)))
names(model_df) <- c("Coefficient", "Value")
players <- f[!f %in% "Punkteschnitt"]
players <- players[!players %in% "Ort"]
players <- players[!players %in% "Platz"]
model_df$Coefficient <- factor(model_df$Coefficient, levels = c("Intercept",
"Punkteschnitt",
"Ort",
"Platz",
players),
ordered = TRUE
)
model_df$Value <- as.numeric(model_df$Value)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
getwd()
jpeg("lm.jpg", width = 800, height = 600)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dev.off()
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
text = element_text(size = 14, hjust = 0.5))
jpeg("lm.jpg", width = 800, height = 600)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
text = element_text(size = 14, hjust = 0.5))
dev.off()
jpeg("lm.jpg", width = 800, height = 600)
ggplot(data = model_df, aes(x = Coefficient, y = Value)) +
geom_bar(stat = "identity") +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
text = element_text(size = 18, hjust = 0.5))
dev.off()
